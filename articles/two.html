<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Data cleaning • ScatMatch</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Data cleaning">
<meta property="og:description" content="ScatMatch">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ScatMatch</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bartesto/ScatMatch/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="two_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Data cleaning</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bartesto/ScatMatch/blob/master/vignettes/two.Rmd"><code>vignettes/two.Rmd</code></a></small>
      <div class="hidden name"><code>two.Rmd</code></div>

    </div>

    
    
<p><img src="plots/scatmatch_logo.png"></p>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>This section of the workflow is about reading in the raw data and formatting it in such a way so that errors can be summarised and the alleles are exported as numerical values. This data can then be visualised in various ways to help determine appropriate amplification and missingness thresholds which will clean the data set prior clustering, covered in the <em>Clustering</em> article.</p>
</div>
<div id="generate-error-summaries-and-numerical-data" class="section level2">
<h2 class="hasAnchor">
<a href="#generate-error-summaries-and-numerical-data" class="anchor"></a>Generate error summaries and numerical data</h2>
<p>To run the next function you will need to know three things which are all parameters for the function. These are:</p>
<ul>
<li><p>filename - the name of the raw data csv that is in the source directory.</p></li>
<li><p>replicates - TRUE or FALSE. Does your raw data have replicate samples?</p></li>
<li><p>suffix - if your data has replicates it will have a suffix at the end of the sample name. Include it here with any separators. Ignore if no replicates.</p></li>
</ul>
<p>Here is the function, change the parameters to suit your needs.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Make some clean data</span>
<span class="fu"><a href="../reference/gen_errors.html">gen_errors</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"CAGRF20021407_raw.csv"</span>, 
           replicates <span class="op">=</span> <span class="cn">TRUE</span>, 
           suffix <span class="op">=</span> <span class="st">"_dup"</span><span class="op">)</span></code></pre></div>
<p>After running this there should be 3 new csv files in the <code>results</code> directory.</p>
<p><img src="plots/fstruct2.png"></p>
<ul>
<li><p><strong>numerical_alleles.csv</strong> - raw data converted to numerical values</p></li>
<li><p><strong>sample_error_results.csv</strong> - average amplification, allele error, locus error, allelic dropout and false allele values per sample.</p></li>
<li><p><strong>summary_error.csv</strong> - gives average and standard error of all the sample errors combined.</p></li>
</ul>
</div>
<div id="apply-thresholds-to-the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#apply-thresholds-to-the-data" class="anchor"></a>Apply thresholds to the data</h2>
<p>Next step is to visualise the data to get an understanding of what amplification value should be used to reduce the dataset. Run the below.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># amplification scatterplots</span>
<span class="fu"><a href="../reference/amp_splots.html">amp_splots</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># amplification histogram</span>
<span class="fu"><a href="../reference/amp_hist.html">amp_hist</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>After running this there will be 2 plots saved as jpg’s as below.</p>
<p><img src="plots/fstruct3.png"></p>
<p>Note that they are in the <code>threhold</code> folder as that is the current task. They will also be printed to screen.</p>
<p>After inspecting the plots and choosing an appropriate amplification threshold (at) run the next function to filter the data. Make sure you apply your at value.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># apply the amplification threshold</span>
<span class="fu"><a href="../reference/amp_threshold.html">amp_threshold</a></span><span class="op">(</span>at <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></code></pre></div>
<p>When that is run it will filter out some samples from the data and will print to screen how many you will lose. It will generate 3 new csv files as per below.</p>
<p><img src="plots/fstruct4.png"></p>
<ul>
<li><p><strong>loci_NA.csv</strong> - a summary of the proportion of NA’s per locus in the filtered data.</p></li>
<li><p><strong>numerical_alleles_filtered_at0.8.csv</strong> - numerical alleles now filtered to the at value.</p></li>
<li><p><strong>samples_filtered_at0.8.csv</strong> - the samples that were filtered from the dataset and what their respective average amplification rates were.</p></li>
</ul>
<p>Next visualise the “missingness” by plotting a histogram.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># missingness histogram</span>
<span class="fu"><a href="../reference/miss_hist.html">miss_hist</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>The functions draw on the proportions of NA’s dataset and creates and saves a histogram to the <code>results/threshold/</code> directory.</p>
<p>After inspecting the histogram and choosing an appropriate missingness threshold (mt) run the next function to further filter the data. Make sure you apply your own at and mt values.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># missingness threshold</span>
<span class="fu"><a href="../reference/miss_threshold.html">miss_threshold</a></span><span class="op">(</span>at <span class="op">=</span> <span class="fl">0.8</span>, mt <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></code></pre></div>
<p>Now the folder structure should look like this.</p>
<p><img src="plots/fstruct5.png"></p>
<p><strong>numerical_alleles_filtered_at0.8_mt0.2.csv</strong> is the numerical alleles now filtered to the at and mt values. Note that the at and mt values will always be saved within the name so that you can keep track of multiple versions. This dataset will be used for all the work to follow so its important that you are happy with it before progressing.</p>
<p>Now that there is a clean dataset, clustering is next and you can read about it in the <em>Clustering</em> article.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Bart Huntley.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
